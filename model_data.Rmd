---
title: "Project 1"
author: "Jacob Cadena"
date: "9/19/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# K-fold cross validation accuracy
cv.10.folds <- createMultiFolds(training.set$num, k = 5, times = 10)

ctrl <- trainControl(method = "repeatedcv",
                     number = 5,
                     repeats = 10,
                     index = cv.10.folds)
```


```{r}

model.builder <- function(formula, data, tr.control,
                  method, family = NULL, tune.length,
                  tune.grid = NULL, show.model = TRUE){
  set.seed(3000)
  model <- train(num ~ .,
                 data = data,
                 trControl = tr.control,
                 method = method,
                 family = family,
                 tuneGrid = tune.grid,
                 tuneLength = tune.length)
  
  if(show.model) print(model)
  
  # Predict on the test set
  y.pred <- predict(model, newdata = test.set[-n])

  # Making the Confusion Matrix
  cm.log.test <- confusionMatrix(y.pred, test.set[,n])
  print(cm.log.test)
  
}

```

```{r}

model.builder(num ~ .,
              data = training.set,
              tr.control = ctrl,
              method = "glm",
              family = binomial,
              tune.length = 10)

```

```{r}
grid.bayes <- expand.grid(
  usekernel = c(TRUE),
  laplace = 0,
  adjust = 0
)

model.builder(num ~ .,
              data = training.set,
              tr.control = ctrl,
              method = "naive_bayes",
              tune.grid = grid.bayes,
              tune.length = 10)
```

```{r}
grid.linear <- expand.grid(C = 5)
set.seed(3000)
model.builder(num ~ .,
              data = training.set,
              tr.control = ctrl,
              method = "svmLinear",
              tune.grid = grid.linear,
              tune.length = 10)

```

```{r}

cv.10.folds <- createMultiFolds(training.set$num, k = 5, times = 1)

ctrl <- trainControl(method = "repeatedcv",
                     number = 5,
                     repeats = 1,
                     index = cv.10.folds)
set.seed(3000)
model.builder(num ~ .,
              data = training.set,
              tr.control = ctrl,
              method = "nnet",
              tune.length = 10,
              show.model = FALSE)
```

